{% extends "base.html" %}

{% block body_class %}
{{ persona.stijl or 'default' }}
{% endblock %}


{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='result.css') }}">
{% endblock %}

{% set huidige_stijl = persona.stijl or 'default' %}

{% block content %}
<h2>Hier is {{ persona.naam or 'je persona' }}!</h2>
<div class="stijl-selector">
    <label for="stijl">Kies een stijl:</label>
    <select id="stijl">
        <option value="default">Standaard</option>
        <option value="stijl1">Zomer</option>
        <option value="stijl2">Donker</option>
        <option value="stijl3">Lente</option>
    </select>
</div>
<div class="result-container">
    <div class="result-kaart">
        <!-- Persoonlijke info -->
        <div class="persona-grid">
            <div class="afbeelding">
                <img src="{{ url_for('static', filename=(
                    'man.png' if (persona.geslacht or '').lower() == 'man' else
                    'vrouw.png' if (persona.geslacht or '').lower() == 'vrouw' else
                    'user.png'
                )) }}" alt="Persona Afbeelding">
            </div>


            <div class="identiteit">
                <p><strong>Naam:</strong> {{ persona.naam or '' }}</p>
                <p><strong>Geslacht:</strong> {{ persona.geslacht or '' }}</p>
                <p><strong>Leeftijd:</strong> {{ persona.leeftijd or '' }}</p>
            </div>

            <div class="leven">
                <p><strong>School/studie:</strong> {{ persona.school or '' }}</p>
                <p><strong>Werk:</strong> {{ persona.werk or '' }}</p>
            </div>

            <div class="persoonlijkheid">
                <p><strong>Doelen:</strong> {{ (persona.doelen or '')|replace('\n','<br>')|safe }}</p>
                <p><strong>Frustraties:</strong> {{ (persona.frustraties or '')|replace('\n','<br>')|safe }}</p>
                <p><strong>Extravert:</strong> {{ persona.extravert or 3 }}/5</p>
                <p><strong>Creatief:</strong> {{ persona.creatief or 3 }}/5</p>
                <p><strong>Intu√Øtief:</strong> {{ persona.intuitief or 3 }}/5</p>
                <p><strong>Stressgevoelig:</strong> {{ persona.stress or 3 }}/5</p>
            </div>
        </div>

    </div>
</div>

<!-- Knoppen -->

<a href="{{ url_for('stap1') }}" class="button">Bewerken</a>
<a href="{{ url_for('nieuw_persona') }}" class="button">Nieuwe persona</a>

<form method="POST" action="{{ url_for('save_persona') }}" style="display:inline">
    <button type="submit" class="button">Opslaan</button>
</form>
<a href="{{ url_for('personas') }}" class="button">
    Terug naar overzicht
</a>


{% endblock %}

{% block extra_js %}
<script>
    const selector = document.getElementById('stijl');

    window.addEventListener('load', () => {
        const savedStyle = "{{ huidige_stijl }}";
        document.body.className = savedStyle;
        selector.value = savedStyle;
    });


    selector.addEventListener('change', () => {
        const stijl = selector.value;
        document.body.className = stijl;

        fetch("/update_stijl", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ stijl })
        });
    });


</script>
{% endblock %}